!function(){"use strict";$(document).ready(function(){function t(t){var h,s,u,g,f,p,I,M,r=t,a=r.split("+"),n=0,e=0,o=0,i=[],c=[],l=[]=i=c,v=[],d=[],m=[],_=l,k=0,C=0;for(n in a)if(a.hasOwnProperty(n)){i[n]=a[n].split("-");for(e in i[n])if(i[n].hasOwnProperty(e)){c[n][e]=i[n][e].split("*");for(o in c[n][e])c[n][e].hasOwnProperty(o)&&(l[n][e][o]=c[n][e][o].split("/"))}}for(g in _)if(_.hasOwnProperty(g)){if(1===_[g].length&&1===_[g][0].length&&1===_[g][0][0].length)_[g]=_[g][0][0][0];else{m=_[g];for(u in m)if(m.hasOwnProperty(u)){if(1===m[u].length&&1===m[u][0].length)m[u]=m[u][0][0];else{d=m[u],f=1;for(s in d)if(d.hasOwnProperty(s)){if("0"===d[s][0]&&1===d[s].length)d[s]=0;else if(0!==d[s][0]&&1===d[s].length)d[s]=d[s][0];else{v=d[s],p=v[0]*v[0];for(h in v)if(v.hasOwnProperty(h)){if(h>0&&"0"===v[h])return $("#calc_tip2").text(" 分母不能为零"),$("#calc_tip2").attr("class","error"),$("#calc_result").attr("class","error"),M="无穷";"0"===v[0]?($("#calc_tip2").text(" 分子为零"),$("#calc_tip2").attr("class","warn"),p=0):p/=v[h]}d[s]=parseFloat(p)}f*=d[s]}m[u]=parseFloat(f)}C-=m[u]}I=2*m[0]+parseFloat(C),_[g]=parseFloat(I)}k+=parseFloat(_[g])}return k}var r=0;$("#calc_toggle").text("展开"),$("#calc_his li:gt(4)").css("display","none"),$("#calc").on("input",function(){var n,a=$("#calc").val().split(" ").join("");""===a?($("#calc_tip2").text(""),$("#calc_result").text("归零"),$("#calc_result,#calc_tip2").attr("class","")):null!==a.match(/[^0-9\+\-\*\/\.]+/g)?($("#calc_tip2").text("输入不正确"),$("#calc_result").text("错误"),$("#calc_result,#calc_tip2").attr("class","error")):null!==a.match(/[\-\+\*\/]{2,}/g)?($("#calc_tip2").text("同时输入了多个运算符"),$("#calc_tip2").attr("class","warn"),$("#calc_result").text("错误"),$("#calc_result").attr("class","error")):null!==a.match(/^[\+\*\/]+/g)?($("#calc_tip2").text("开头不要运算符号"),$("#calc_tip2").attr("class","warn"),$("#calc_result").text("错误"),$("#calc_result").attr("class","error")):null!==a.match(/\D$/g)?($("#calc_tip2").text(" 请继续输入数字"),$("#calc_tip2").attr("class","warn")):($("#calc_result,#calc_tip2").attr("class",""),$("#calc_tip2").text("计算结果"),n=t(a),$("#calc_result").text(n),$("#calc_his").prepend('<li class="input_his"><span class="myinput_his">'+a+'</span><span class="eq_his">=</span><span class="result_his">'+n+'</span><span class="index_his"># '+(r+=1)+"</span></li>")),$("#calc_his li").length>10&&$("#calc_his li:gt(9)").remove(),$("#calc_his li:has(span)").hover(function(){0===$(".index_his_tip").length&&$(this).append('<span class="index_his_tip">回退</span>')},function(){$(this).children(".index_his_tip").remove()}),"展开"===$("#calc_toggle").text()&&$("#calc_his li:gt(4)").css("display","none"),$("#calc_his li:has(span)").on("click",function(){$("#calc").val($(this).children(".myinput_his").text()),$("#calc_result").text($(this).children(".result_his").text()),$("#calc_tip2").text(""),$("#calc_result,#calc_tip2").attr("class","")})}),$("#calc_clear").on("click",function(){return $("#calc_his li").empty().removeAttr("class"),$("#calc_his li").unbind("click"),$("#calc_his li:has(span)").unbind("hover"),r=0}),$("#calc_reset").on("click",function(){return $("#calc_his li").empty().removeAttr("class"),$("#calc_his li").unbind("click"),$("#calc_his li:has(span)").unbind("hover"),$("#calc_tip2").text(""),$("#calc_result").text("归零"),$("#calc_result,#calc_tip2").attr("class",""),$("#calc").val(""),r=0}),$("#calc_toggle").click(function(){"收起"===$("#calc_toggle").text()?($("#calc_toggle").text("展开"),$("#calc_his li:gt(4)").slideUp(300,"linear")):"展开"===$("#calc_toggle").text()&&($("#calc_toggle").text("收起"),$("#calc_his li:gt(4)").slideDown(300,"linear"))}),$("input#type_bin").on("input",function(){var t=$("#type_bin").val().split(" ").join("");null!==t.match(/[\D2-9]+/g)?$("#hex_tip").html("请输入 <kbd>0</kbd> 到 <kbd>1</kbd> 范围内的字符").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_dec").val(parseInt(t,2)),$("#type_oct").val(parseInt(t,2).toString(8)),$("#type_hex").val(parseInt(t,2).toString(16)))}),$("input#type_oct").on("input",function(){var t=$("#type_oct").val().split(" ").join("");null!==t.match(/[\D89]+/g)?$("#hex_tip").html("请输入 <kbd>0</kbd> 到 <kbd>7</kbd> 范围内的字符").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_dec").val(parseInt(t,8)),$("#type_bin").val(parseInt(t,8).toString(2)),$("#type_hex").val(parseInt(t,8).toString(16)))}),$("input#type_dec").on("input",function(){var t=$("#type_dec").val().split(" ").join("");null!==t.match(/\D+/g)?$("#hex_tip").html("请输入 <kbd>0</kbd> 到 <kbd>9</kbd> 范围内的字符").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_bin").val(parseInt(t,10).toString(2)),$("#type_oct").val(parseInt(t,10).toString(8)),$("#type_hex").val(parseInt(t,10).toString(16)))}),$("input#type_hex").on("input",function(){var t=$("#type_hex").val().split(" ").join("");null!==t.match(/[g-zG-Z\W]+/g)?$("#hex_tip").html("请输入数字字符及 <kbd>A</kbd> 到 <kbd>F</kbd> 范围内的字母").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_dec").val(parseInt(t,16)),$("#type_oct").val(parseInt(t,16).toString(8)),$("#type_bin").val(parseInt(t,16).toString(2)))}),$("#type_uriencode").on("input",function(){var t=$("#type_uriencode").val();$("#type_uridecode").val(encodeURI(t))}),$("#type_uridecode").on("input",function(){var t=$("#type_uridecode").val();$("#type_uriencode").val(decodeURI(t))})})}();