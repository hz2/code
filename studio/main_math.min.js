(function(){"use strict";$(document).ready(function(){function t(t){var e,c,l,a,i,n,s,r,p=t,_=p.split("+"),o=0,u=0,h=0,d=[],x=[],v=[]=d=x,g=[],y=[],f=[],b=v,k=0,m=0;for(o in _)if(_.hasOwnProperty(o)){d[o]=_[o].split("-");for(u in d[o])if(d[o].hasOwnProperty(u)){x[o][u]=d[o][u].split("*");for(h in x[o][u])x[o][u].hasOwnProperty(h)&&(v[o][u][h]=x[o][u][h].split("/"))}}for(a in b)if(b.hasOwnProperty(a)){if(1===b[a].length&&1===b[a][0].length&&1===b[a][0][0].length)b[a]=b[a][0][0][0];else{f=b[a];for(l in f)if(f.hasOwnProperty(l)){if(1===f[l].length&&1===f[l][0].length)f[l]=f[l][0][0];else{y=f[l],i=1;for(c in y)if(y.hasOwnProperty(c)){if("0"===y[c][0]&&1===y[c].length)y[c]=0;else if(0!==y[c][0]&&1===y[c].length)y[c]=y[c][0];else{g=y[c],n=g[0]*g[0];for(e in g)if(g.hasOwnProperty(e)){if(e>0&&"0"===g[e])return $("#calc_tip2").text(" 分母不能为零"),$("#calc_tip2").attr("class","error"),$("#calc_result").attr("class","error"),r="无穷";"0"===g[0]?($("#calc_tip2").text(" 分子为零"),$("#calc_tip2").attr("class","warn"),n=0):n/=g[e]}y[c]=parseFloat(n)}i*=y[c]}f[l]=parseFloat(i)}m-=f[l]}s=2*f[0]+parseFloat(m),b[a]=parseFloat(s)}k+=parseFloat(b[a])}return k}var e=0;$("#calc_toggle").text("展开"),$("#calc_his li:gt(4)").css("display","none"),$("#calc").on("input",function(){var c,l=$("#calc").val().split(" ").join("");""===l?($("#calc_tip2").text(""),$("#calc_result").text("归零"),$("#calc_result,#calc_tip2").attr("class","")):null!==l.match(/[^0-9\+\-\*\/\.]+/g)?($("#calc_tip2").text("输入不正确"),$("#calc_result").text("错误"),$("#calc_result,#calc_tip2").attr("class","error")):null!==l.match(/[\-\+\*\/]{2,}/g)?($("#calc_tip2").text("同时输入了多个运算符"),$("#calc_tip2").attr("class","warn"),$("#calc_result").text("错误"),$("#calc_result").attr("class","error")):null!==l.match(/^[\+\*\/]+/g)?($("#calc_tip2").text("开头不要运算符号"),$("#calc_tip2").attr("class","warn"),$("#calc_result").text("错误"),$("#calc_result").attr("class","error")):null!==l.match(/\D$/g)?($("#calc_tip2").text(" 请继续输入数字"),$("#calc_tip2").attr("class","warn")):($("#calc_result,#calc_tip2").attr("class",""),$("#calc_tip2").text("计算结果"),c=t(l),$("#calc_result").text(c),$("#calc_his").prepend('<li class="input_his"><span class="myinput_his">'+l+'</span><span class="eq_his">=</span><span class="result_his">'+c+'</span><span class="index_his"># '+(e+=1)+"</span></li>")),$("#calc_his li").length>10&&$("#calc_his li:gt(9)").remove(),$("#calc_his li:has(span)").hover(function(){0===$(".index_his_tip").length&&$(this).append('<span class="index_his_tip">回退</span>')},function(){$(this).children(".index_his_tip").remove()}),"展开"===$("#calc_toggle").text()&&$("#calc_his li:gt(4)").css("display","none"),$("#calc_his li:has(span)").on("click",function(){$("#calc").val($(this).children(".myinput_his").text()),$("#calc_result").text($(this).children(".result_his").text()),$("#calc_tip2").text(""),$("#calc_result,#calc_tip2").attr("class","")})}),$("#calc_clear").on("click",function(){return $("#calc_his li").empty().removeAttr("class"),$("#calc_his li").unbind("click"),$("#calc_his li:has(span)").unbind("hover"),e=0}),$("#calc_reset").on("click",function(){return $("#calc_his li").empty().removeAttr("class"),$("#calc_his li").unbind("click"),$("#calc_his li:has(span)").unbind("hover"),$("#calc_tip2").text(""),$("#calc_result").text("归零"),$("#calc_result,#calc_tip2").attr("class",""),$("#calc").val(""),e=0}),$("#calc_toggle").click(function(){"收起"===$("#calc_toggle").text()?($("#calc_toggle").text("展开"),$("#calc_his li:gt(4)").slideUp(300,"linear")):"展开"===$("#calc_toggle").text()&&($("#calc_toggle").text("收起"),$("#calc_his li:gt(4)").slideDown(300,"linear"))}),$("input#type_bin").on("input",function(){var t=$("#type_bin").val().split(" ").join("");null!==t.match(/[\D2-9]+/g)?$("#hex_tip").html("请输入 <kbd>0</kbd> 到 <kbd>1</kbd> 范围内的字符").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_dec").val(parseInt(t,2)),$("#type_oct").val(parseInt(t,2).toString(8)),$("#type_hex").val(parseInt(t,2).toString(16)))}),$("input#type_oct").on("input",function(){var t=$("#type_oct").val().split(" ").join("");null!==t.match(/[\D89]+/g)?$("#hex_tip").html("请输入 <kbd>0</kbd> 到 <kbd>7</kbd> 范围内的字符").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_dec").val(parseInt(t,8)),$("#type_bin").val(parseInt(t,8).toString(2)),$("#type_hex").val(parseInt(t,8).toString(16)))}),$("input#type_dec").on("input",function(){var t=$("#type_dec").val().split(" ").join("");null!==t.match(/\D+/g)?$("#hex_tip").html("请输入 <kbd>0</kbd> 到 <kbd>9</kbd> 范围内的字符").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_bin").val(parseInt(t,10).toString(2)),$("#type_oct").val(parseInt(t,10).toString(8)),$("#type_hex").val(parseInt(t,10).toString(16)))}),$("input#type_hex").on("input",function(){var t=$("#type_hex").val().split(" ").join("");null!==t.match(/[g-zG-Z\W]+/g)?$("#hex_tip").html("请输入数字字符及 <kbd>A</kbd> 到 <kbd>F</kbd> 范围内的字母").attr("class","error"):""===t?($("input").val(""),$("#hex_tip").text("输入数字，自动转化成其他进制").attr("class","")):($("#hex_tip").text("输入数字，自动转化成其他进制").attr("class",""),$("#type_dec").val(parseInt(t,16)),$("#type_oct").val(parseInt(t,16).toString(8)),$("#type_bin").val(parseInt(t,16).toString(2)))}),$("#type_uriencode").on("input",function(){var t=$("#type_uriencode").val();$("#type_uridecode").val(encodeURI(t))}),$("#type_uridecode").on("input",function(){var t=$("#type_uridecode").val();$("#type_uriencode").val(decodeURI(t))}),$("#type_uriencode").on("input",function(){var t=$("#type_uriencode").val();$("#type_uridecode").val(encodeURI(t))}),$("#type_uridecode").on("input",function(){var t=$("#type_uridecode").val();$("#type_uriencode").val(decodeURI(t))})})})();