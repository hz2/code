$(document).ready(function(){function t(){$(".user_status").text($('input[type="radio"]:checked+label').text())}function e(t){var e,o=Math.floor(4901*Math.random()+100);"books"===t?e="https://api.douban.com/v2/book/search?tag=%E6%96%87%E5%AD%A6&start="+o+"&count=1&fields=id,title,author,pubdate,images,rating&callback=?":"musics"===t?e="https://api.douban.com/v2/music/search?tag=%E5%8D%8E%E8%AF%AD&start="+o+"&count=1&callback=?":"movies"===t?e="https://api.douban.com/v2/movie/in_theaters?callback=?":"bookid"===t?e="https://api.douban.com/v2/book/"+$("#text_1").val()+"?callback=?":"musicid"===t?e="https://api.douban.com/v2/music/"+$("#text_1").val()+"?callback=?":"movieid"===t&&(e="https://api.douban.com/v2/movie/subject/"+$("#text_1").val()+"?callback=?"),$.ajax({url:e,dataType:"json",beforeSend:function(){"books"!==t&&"movies"!==t&&"musics"!==t||$(".loading").show()},success:function(e){var o,a,i,s,r,n,c,d,l;"books"===t?l=e.books[0]:"musics"===t?l=e.musics[0]:"movies"===t?l=e.subjects[Math.floor(20*Math.random())]:"bookid"!==t&&"musicid"!==t&&"movieid"!==t||(l=e),"books"===t||"bookid"===t?(s=l.rating.numRaters,r=l.author[0],n=l.pubdate,c=l.images.large):"musics"===t||"musicid"===t?(s=l.rating.numRaters,r=l.author[0].name,n=l.attrs.pubdate[0],c=l.image.replace(/spic/i,"lpic")):"movies"!==t&&"movieid"!==t||(s=l.collect_count,r=l.directors[0].name,n=l.casts[0].name,c=l.images.large),o=l.id,a=l.title,i=l.rating.average,d=10*parseFloat(i).toFixed()/2,$("#text_1").val(o),$("#title").text(a),$("#title").attr("title",a),$("#bigstar").attr("class","bigstar"+d),$("#num").text(s),$("#star").text(i),$("#director").text(r),$("#director").attr("title",r),$("#actor").text(n),$("#actor").attr("title",n),$("#pic,.screen").css("background-image","url("+c+")"),$(".loading,.error").hide()},error:function(){$(".loading").hide(),$(".error").show(),$(".error").text("输入的 id 不正确"),""===$("#text_1").val()&&"bookid"===t?$(".error").text("请输入书籍ID"):""===$("#text_1").val()&&"musicid"===t?$(".error").text("请输入音乐ID"):""===$("#text_1").val()&&"movieid"===t?$(".error").text("请输入电影ID"):($(".loadinginfo").text("加载失败，请刷新页面"),$(".loadingicon").addClass("loadingicon2").removeClass("loadingicon"))}})}function o(){$("#booktab").addClass("current"),$(".tab>div:not(#booktab)").removeClass("current"),$("#your_id").text("请输入书籍ID"),$("#text_2").val("读者"),$("#text_4").val("很不错的书！"),$('#dmovie [for="d_todo"]').text("想读"),$('#d_doing,#dmovie [for="d_doing"]').removeAttr("style"),$('#dmovie [for="d_doing"]').text("在读"),$('#dmovie [for="d_done"]').text("读过"),$("#title_d").text("作者："),$("#title_a").text("出版时间："),t(),e("books"),$("#user_name").text($("#text_2").val()),$("#user_text").text($("#text_4").val())}function a(){$("#musictab").addClass("current"),$(".tab>div:not(#musictab)").removeClass("current"),$("#your_id").text("请输入音乐ID"),$("#text_2").val("听众"),$("#text_4").val("很好听的音乐！"),$('#dmovie [for="d_todo"]').text("想听"),$('#d_doing,#dmovie [for="d_doing"]').removeAttr("style"),$('#dmovie [for="d_doing"]').text("在听"),$('#dmovie [for="d_done"]').text("听过"),$("#title_d").text("表演者："),$("#title_a").text("发行时间："),t(),e("musics"),$("#user_name").text($("#text_2").val()),$("#user_text").text($("#text_4").val())}function i(){$("#movietab").addClass("current"),$(".tab>div:not(#movietab)").removeClass("current"),$("#your_id").text("请输入电影ID"),$("#text_2").val("观众"),$("#text_4").val("很棒的电影！"),$('#dmovie [for="d_todo"]').text("想看"),$('#dmovie [for="d_doing"],#d_doing').css("display","none"),$('#dmovie [for="d_done"]').text("看过"),$("#title_d").text("导演："),$("#title_a").text("主演："),t(),e("movies"),$("#user_name").text($("#text_2").val()),$("#user_text").text($("#text_4").val())}console.clear(),console.log("%c觉得页面很棒？😊\n联系作者 hu2x@qq.com","color:teal;"),function(){var t=$("#ribbon_text");/oschina/i.test(window.location.host)?t.attr("href","//git.oschina.net/h2x/h2x/tree/master"+window.location.pathname).find("span").text("GitOSC"):t.attr("href","//github.com/hcw/hcw.github.io/tree/master"+window.location.pathname).find("span").text("Github")}(),$("#dmovie input").click(function(t){$("#d_todo").prop("checked")===!0?($("#user_star,.starval,#starval").hide(),$("#user_status").css("margin","15px")):($("#user_star,.starval,#starval").show(),$("#user_status").removeAttr("style"))}),$("#user_name").text($("#text_2").val()),$("#user_pic").css("background-image","url("+$("#text_3").val()+")"),$("#user_text").text($("#text_4").val()),$("#starval").change(function(){$("#user_star").attr("class",$("#starval").val())}),$('input[type="radio"]').change("input",function(){$(".user_status").text($('input[type="radio"]:checked+label').text())}),$("#text_2").on("input",function(){$("#user_name").text($("#text_2").val())}),$("#text_3").on("input",function(){$("#user_pic").css("background-image","url("+$("#text_3").val()+")")}),$("#text_4").on("input",function(){$("#user_text").text($("#text_4").val())}),$("#text_1").on("input",function(){e("#book"===window.location.hash?"bookid":"#music"===window.location.hash?"musicid":"#movie"===window.location.hash?"movieid":"movieid")}),$("#booktab").click(function(){o()}),$("#musictab").click(function(){a()}),$("#movietab").click(function(){i()});var s=window.location.hash;switch(s){case"#book":o();break;case"#music":a();break;case"#movie":i();break;default:i()}});