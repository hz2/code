$(document).ready(function(){function t(){$(".user_status").text($('input[type="radio"]:checked+label').text())}function e(t){var e,o=Math.floor(4901*Math.random()+100);"books"===t?e="https://api.douban.com/v2/book/search?tag=%E6%96%87%E5%AD%A6&start="+o+"&count=1&fields=id,title,author,pubdate,images,rating&callback=?":"musics"===t?e="https://api.douban.com/v2/music/search?tag=%E5%8D%8E%E8%AF%AD&start="+o+"&count=1&callback=?":"movies"===t?e="https://api.douban.com/v2/movie/in_theaters?callback=?":"bookid"===t?e="https://api.douban.com/v2/book/"+$("#text_1").val()+"?callback=?":"musicid"===t?e="https://api.douban.com/v2/music/"+$("#text_1").val()+"?callback=?":"movieid"===t&&(e="https://api.douban.com/v2/movie/subject/"+$("#text_1").val()+"?callback=?"),$.ajax({url:e,dataType:"json",beforeSend:function(){"books"!==t&&"movies"!==t&&"musics"!==t||$(".loading").show()},success:function(e){var o,a,i,s,r,n,c,d,l;"books"===t?l=e.books[0]:"musics"===t?l=e.musics[0]:"movies"===t?l=e.subjects[Math.floor(20*Math.random())]:"bookid"!==t&&"musicid"!==t&&"movieid"!==t||(l=e),"books"===t||"bookid"===t?(s=l.rating.numRaters,r=l.author[0],n=l.pubdate,c=l.images.large):"musics"===t||"musicid"===t?(s=l.rating.numRaters,r=l.author[0].name,n=l.attrs.pubdate[0],c=l.image.replace(/spic/i,"lpic")):"movies"!==t&&"movieid"!==t||(s=l.collect_count,r=l.directors[0].name,n=l.casts[0].name,c=l.images.large),o=l.id,a=l.title,i=l.rating.average,d=10*parseFloat(i).toFixed()/2,$("#text_1").val(o),$("#title").text(a),$("#title").attr("title",a),$("#bigstar").attr("class","bigstar"+d),$("#num").text(s),$("#star").text(i),$("#director").text(r),$("#director").attr("title",r),$("#actor").text(n),$("#actor").attr("title",n),$("#pic,.screen").css("background-image","url("+c+")"),$(".loading,.error").hide()},error:function(){$(".loading").hide(),$(".error").show(),$(".error").text("è¾“å…¥çš„ id ä¸æ­£ç¡®"),""===$("#text_1").val()&&"bookid"===t?$(".error").text("è¯·è¾“å…¥ä¹¦ç±ID"):""===$("#text_1").val()&&"musicid"===t?$(".error").text("è¯·è¾“å…¥éŸ³ä¹ID"):""===$("#text_1").val()&&"movieid"===t?$(".error").text("è¯·è¾“å…¥ç”µå½±ID"):($(".loadinginfo").text("åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢"),$(".loadingicon").addClass("loadingicon2").removeClass("loadingicon"))}})}function o(){$("#booktab").addClass("current"),$(".tab>div:not(#booktab)").removeClass("current"),$("#your_id").text("è¯·è¾“å…¥ä¹¦ç±ID"),$("#text_2").val("è¯»è€…"),$("#text_4").val("å¾ˆä¸é”™çš„ä¹¦ï¼"),$('#dmovie [for="d_todo"]').text("æƒ³è¯»"),$('#d_doing,#dmovie [for="d_doing"]').removeAttr("style"),$('#dmovie [for="d_doing"]').text("åœ¨è¯»"),$('#dmovie [for="d_done"]').text("è¯»è¿‡"),$("#title_d").text("ä½œè€…ï¼š"),$("#title_a").text("å‡ºç‰ˆæ—¶é—´ï¼š"),t(),e("books"),$("#user_name").text($("#text_2").val()),$("#user_text").text($("#text_4").val())}function a(){$("#musictab").addClass("current"),$(".tab>div:not(#musictab)").removeClass("current"),$("#your_id").text("è¯·è¾“å…¥éŸ³ä¹ID"),$("#text_2").val("å¬ä¼—"),$("#text_4").val("å¾ˆå¥½å¬çš„éŸ³ä¹ï¼"),$('#dmovie [for="d_todo"]').text("æƒ³å¬"),$('#d_doing,#dmovie [for="d_doing"]').removeAttr("style"),$('#dmovie [for="d_doing"]').text("åœ¨å¬"),$('#dmovie [for="d_done"]').text("å¬è¿‡"),$("#title_d").text("è¡¨æ¼”è€…ï¼š"),$("#title_a").text("å‘è¡Œæ—¶é—´ï¼š"),t(),e("musics"),$("#user_name").text($("#text_2").val()),$("#user_text").text($("#text_4").val())}function i(){$("#movietab").addClass("current"),$(".tab>div:not(#movietab)").removeClass("current"),$("#your_id").text("è¯·è¾“å…¥ç”µå½±ID"),$("#text_2").val("è§‚ä¼—"),$("#text_4").val("å¾ˆæ£’çš„ç”µå½±ï¼"),$('#dmovie [for="d_todo"]').text("æƒ³çœ‹"),$('#dmovie [for="d_doing"],#d_doing').css("display","none"),$('#dmovie [for="d_done"]').text("çœ‹è¿‡"),$("#title_d").text("å¯¼æ¼”ï¼š"),$("#title_a").text("ä¸»æ¼”ï¼š"),t(),e("movies"),$("#user_name").text($("#text_2").val()),$("#user_text").text($("#text_4").val())}console.clear(),console.log("%cè§‰å¾—é¡µé¢å¾ˆæ£’ï¼ŸğŸ˜Š\nè”ç³»ä½œè€… hu2x@qq.com","color:teal;"),function(){var t=$("#ribbon_text");/oschina/i.test(window.location.host)?t.attr("href","//git.oschina.net/h2x/h2x/tree/master"+window.location.pathname).find("span").text("GitOSC"):t.attr("href","//github.com/hcw/hcw.github.io/tree/master"+window.location.pathname).find("span").text("Github")}(),$("#dmovie input").click(function(t){$("#d_todo").prop("checked")===!0?($("#user_star,.starval,#starval").hide(),$("#user_status").css("margin","15px")):($("#user_star,.starval,#starval").show(),$("#user_status").removeAttr("style"))}),$("#user_name").text($("#text_2").val()),$("#user_pic").css("background-image","url("+$("#text_3").val()+")"),$("#user_text").text($("#text_4").val()),$("#starval").change(function(){$("#user_star").attr("class",$("#starval").val())}),$('input[type="radio"]').change("input",function(){$(".user_status").text($('input[type="radio"]:checked+label').text())}),$("#text_2").on("input",function(){$("#user_name").text($("#text_2").val())}),$("#text_3").on("input",function(){$("#user_pic").css("background-image","url("+$("#text_3").val()+")")}),$("#text_4").on("input",function(){$("#user_text").text($("#text_4").val())}),$("#text_1").on("input",function(){e("#book"===window.location.hash?"bookid":"#music"===window.location.hash?"musicid":"#movie"===window.location.hash?"movieid":"movieid")}),$("#booktab").click(function(){o()}),$("#musictab").click(function(){a()}),$("#movietab").click(function(){i()});var s=window.location.hash;switch(s){case"#book":o();break;case"#music":a();break;case"#movie":i();break;default:i()}});